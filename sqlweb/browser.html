<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>SQL Power!</title>
	<meta name="generator" content="TextMate http://macromates.com/">
	<meta name="author" content="Matt Youell">

	<style>
	.box {
	    border: 1px solid #ccc;
	    background-color: #eee;
    }
    .foo {
        background-color: #eee;
    }
    
    #txt_email, #txt_password {
     width: 100%;   
    }
    
	</style>
	<script src="jquery-1.4.2.min.js"></script>
	<script>
	var SqlScript = function() {
	    return $('script[language=SQL]').text().trim();
    }

	var SubmitForm = function() {
	    
	    $('input[type=text]').each( function(){
	        console.log( $(this).attr("id") );
        });
	    
	    var sql = SqlScript();
	    
	    if( (/^select/i).test(sql) ) {
	     
	     console.log("SELECT found: " + sql);
	     
	     var matches = /^select\s+(.*)\s+from\s+(.*)\s+where\s+(.*);/g.exec(sql);

         for(var i = 0; i < matches.length; i++)
         {
	         console.log("Match " + i + ": " + matches[i]);
         }

         var jqstr = "$('" + matches[2] + " input[" + matches[3] + "]')";

         console.log(eval(jqstr).length + " items match the query.");

         eval(jqstr).each(function() {
             console.log($(this)[0].id + " = " + $(this)[0].value);
         });


        }
        else {
            console.log("that's not a select statement?");
	    }
	    
	    return false;

    }

	$(function() {
	    var divs = $('div'); // Need to better understand how to iterate over these.
	    divs.addClass("foo");
	    
	    $('#btn_submit').click(SubmitForm);
	    
    });
	</script>

	<script language="SQL">
	select id, value from #registration_form where type="text";
	</script>
</head>
<body>

<div id="box-A" class="box">
    A
    <h5>foo</h5>
</div>

<div id="box-B" class="box">
    B
</div>

<div id="box-C" class="box">
    C
</div>
    
<div id="box-D" class="box">
    D
</div>

<div id="box-E" class="box">
    E
</div>

<form id="registration_form">
<table style="border: 1px dashed #ccc">
    <tr>
        <td>First</td>
        <td>Last</td>
    </tr>
    <tr>
        <td><input type="text" id="txt_name_first"></td>
        <td><input type="text" id="txt_name_last"></td>
    </tr>
    <tr>
        <td colspan="2">Email</td>
    </tr>
    <tr>
        <td colspan="2"><input type="text" id="txt_email"></td>
    </tr>
    <tr>
        <td colspan="2">Password</td>
    </tr>
    <tr>
        <td colspan="2"><input type="text" id="txt_password"></td>
    </tr>
    <tr>
        <td align="right" colspan="2"><input type="submit" id="btn_submit"></td>
    </tr>
</table>
</form>


    
</body>
</html>
